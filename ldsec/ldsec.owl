@prefix : <http://www.w3.org/ns/ldsec#> .
@prefix ldsec: <http://www.w3.org/ns/ldsec#> .
@prefix owl: <http://www.w3.org/2002/07/owl#> .
@prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> .
@prefix xml: <http://www.w3.org/XML/1998/namespace> .
@prefix xsd: <http://www.w3.org/2001/XMLSchema#> .
@prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#> .
@base <http://www.w3.org/ns/ldsec#> .

<http://www.w3.org/ns/ldsec#> a owl:Ontology;
  rdfs:comment "A signature/encryption vocabulary"@en .

:JSONWebSignature a rdfs:Datatype ;
  rdfs:comment "A JSON Web Signature in Compact Form";
  owl:onDataype xsd:base64Binary .

:Verification a owl:Class ;
  rdfs:comment "Provides cryptographic verification for a subject" .

:verifies a owl:ObjectProperty, owl:FunctionalProperty ;
  rdfs:comment "The Subject verified by a Verification" ;
  rdfs:range owl:Thing ;
  rdfs:domain :Verification;
  owl:inverseOf :verifiedBy .

:verifiedBy a owl:ObjectProperty, owl:FunctionalProperty ;
  rdfs:comment "Specifies a Verification that verifies the Subject" ;
  rdfs:range :Verification ;
  rdfs:domain owl:Thing;
  owl:inverseOf :verifies .

:transform a owl:ObjectProperty, owl:FunctionalProperty ;
  rdfs:comment "Identifies the transformation/c14n algorithm used to prepare the Subject data for verification generation" ;
  rdfs:range :Algorithm ;
  rdfs:domain :Verification .

:alg a owl:ObjectProperty, owl:FunctionalProperty ;
  rdfs:comment "Identifies a cryptographic algorithm used to generate a verification." ;
  rdfs:range :Algorithm ;
  rdfs:domain [
    a owl:Class ;
      owl:unionOf ( :Verification :Key :CipherObject ) .
  ] .

:key a owl:ObjectProperty ;
  rdfs:comment "Identifies one or more keys used to generate the verification." ;
  rdfs:range [
    a owl:Class ;
    owl:unionOf ( owl:Thing :JSONEncryptedKey :Key :KeySet ) .
  ] ;
  rdfs:domain :Verification .

:x509 a owl:ObjectProperty ;
  rdfs:comment "Identifies one or more x.509 Certificates." ;
  rdfs:range [
    a owl:Class ;
      owl:unionOf ( owl:Thing :Thumbprint rdf:List ) .
  ] ;
  rdfs:domain [
    a owl:Class ;
      owl:unionOf ( :Verification :Key )
  ] ;

:sig a owl:DatatypeProperty, owl:FunctionalProperty ;
  rdfs:comment "Specifies the verification signature" ;
  rdfs:range [ 
    a owl:Class ;
      owl:unionOf ( xsd:hexBinary xsd:base64Binary ) .
  ];
  rdfs:domain :Verification .

## Thumbprints

:Thumbprint a rdf:Dataype .
:SHA1Thumbprint a rdf:Dataype ;
  rdfs:subClassOf :Thumbprint .
:SHA256Thumbprint a rdf:Datatype ;
  rdfs:subClassOf :Thumbprint .

## Key

:KeySet a owl:Class ;
  rdfs:comment "An unordered set of keys" .

:hasKey a owl:ObjectProperty ;
  rdfs:range :Key,
  rdfs:domain :KeySet .

:Key a owl:Class ;
  rdfs:comment "A cryptographic key" .

:PublicKey a owl:Class ;
  rdfs:comment "A Public Key" ;
  rdfs:subClassOf :Key .

:PrivateKey a owl:Class ;
  rdfs:comment "A Private Key" ;
  rdfs:subClassOf :Key .

:kid a owl:DatatypeProperty, owl:FunctionalProperty ;
  rdfs:comment "A free-form key identifier. Should we just use rdf:label or prefLabel?" ;
  rdfs:domain :Key .

:use a owl:ObjectProperty ;
  rdfs:comment "Identifies the intended usage of a key" ;
  rdfs:domain :Key ;
  rdfs:range :Usage .

## Encrypted Key

:EncryptedKey a rdfs:Datatype .
:JSONEncryptedKey a rdfs:Datatype ;
  rdfs:subClassOf :EncryptedKey, :JSONWebEncryption ;
  rdfs:comment "An Encrypted JSON Web Key" .

## A Key Pair

:KeyPair a owl:Class ;
  rdfs:comment "A cryptographic key pair" .

:hasPublicKey a owl:ObjectProperty, owl:FunctionalProperty ;
  rdfs:comment "The public key component of a key pair" ;
  rdfs:range :PublicKey ;
  rdfs:domain :KeyPair .
:hasPrivateKey a owl:ObjectProperty, owl:FunctionalProperty ;
  rdfs:comment "The private key component of a key pair" ;
  rdfs:range :PrivateKey ;
  rdfs:domain :KeyPair .

## Eliptic Curve Keys

:ECKey a owl:Class ;
  rdfs:comment "An Eliptic Curve Key" ;
  rdfs:subClassOf :Key .

:ECKeyPair a owl:Class ;
  rdfs:comment "An Eliptic Curve Key Pair" ;
  rdfs:subClassOf :KeyPair .

:ECPublicKey a owl:Class ;
  rdfs:comment "An Eliptic Curve Public Key" ;
  rdfs:subClassOf :ECKey, :PublicKey .

:ECPrivateKey a owl:Class ;
  rdfs:comment "An Eliptic Curve Private Key" ;
  rdfs:subClassOf :ECKey, :PrivateKey .

:crv a owl:DatatypeProperty, owl:FunctionalProperty ;
  rdfs:comment "A Eliptic Curve Identifier" ;
  rdfs:domain :ECKey .

:x a owl:DatatypeProperty, owl:FunctionalProperty ;
  rdfs:comment "X-Coordinate" ;
  rdfs:domain :ECKey .

:y a owl:DatatypeProperty, owl:FunctionalProperty ;
  rdfs:comment "Y-Coordinate" ;
  rdfs:domain :ECKey .

:d a owl:DatatypeProperty, owl:FunctionalProperty ;
  rdfs:comment "D-Parameter" ;
  rdfs:domain [
    a owl:Class ;
      owl:unionOf ( :ECPrivateKey :RSAPrivateKey ) .

## RSA Curves

:RSAKey a owl:Class ;
  rdfs:comment "An RSA Key" ;
  rdfs:subClassOf :Key .

:RSAKeyPair a owl:Class ;
  rdfs:comment "An RSA Key Pair" ;
  rdfs:subClassOf :KeyPair .

:RSAPublicKey a owl:Class ;
  rdfs:comment "An RSA Public Key" ;
  rdfs:subClassOf :RSAKey, :PublicKey .

:RSAPrivateKey a owl:Class ;
  rdfs:comment "An RSA Private Key" ;
  rdfs:subClassOf :RSAKey, :PrivateKey .

:n a owl:DatatypeProperty, owl:FunctionalProperty ;
  rdfs:comment "Modulus" ;
  rdfs:domain :RSAKey .

:e a owl:DatatypeProperty, owl:FunctionalProperty ;
  rdfs:comment "Exponent" ;
  rdfs:domain :RSAKey .

:p a owl:DatatypeProperty, owl:FunctionalProperty ;
  rdfs:comment "Private Exponent" ;
  rdfs:domain :RSAPrivateKey .

:q a owl:DatatypeProperty, owl:FunctionalProperty ;
  rdfs:comment "Second Prime Factor" ;
  rdfs:domain :RSAPrivateKey .

:dp a owl:DatatypeProperty, owl:FunctionalProperty ;
  rdfs:comment "First Factor CRT Exponent" ;
  rdfs:domain :RSAPrivateKey .

:dq a owl:DatatypeProperty, owl:FunctionalProperty ;
  rdfs:comment "Second Factor CRT Exponent" ;
  rdfs:domain :RSAPrivateKey .

:qi a owl:DatatypeProperty, owl:FunctionalProperty ;
  rdfs:comment "First CRT Coefficient" ;
  rdfs:domain :RSAPrivateKey .

:oth a owl:DatatypeProperty, owl:FunctionalProperty ;
  rdfs:comment "Other Primes Info" ;
  rdfs:domain :RSAPrivateKey .

:r a owl:DatatypeProperty, owl:FunctionalProperty ;
  rdfs:comment "Prime Factor" ;
  rdfs:domain :RSAPrivateKey .

:t a owl:DatatypeProperty, owl:FunctionalProperty ;
  rdfs:comment "Factor CRT Coefficient" ;
  rdfs:domain :RSAPrivateKey .

## Symmetric Keys

:SymmetricKey a owl:Class ;
  rdfs:subClassOf :Key .

:k a owl:DatatypeProperty, owl:FunctionalProperty ;
  rdfs:comment "The key data" ;
  rdfs:domain :SymmetricKey .

## Key Usage and Operations

:Usage a owl:Class ;
  rdfs:subClassOf owl:Class ;
  rdfs:comment "Describes how a key is used" .
:Signature a :Usage ;
:Sign a :Usage ;
  rdfs:subClassOf :Signature .
:Verify a :Usage ;
  rdfs:subClassOf :Signature .


## CipherObject

:JSONWebEncryption a rdfs:Datatype ;
  rdfs:comment "A JSON Web Encryption in Compact Form" ;
  owl:onDatatype xsd:base64Binary .

:CipherObject a owl:Class ;
  rdfs:comment "Encrypted Data" .

  ## :alg, :key, :x509, :kid all apply
  ## :alg is the content encryption algorithm in this case
  ## the :key might be an encrypted key, but if it is, it'll have it's own details...

:zip a owl:ObjectProperty, owl:FunctionalProperty ;
  rdfs:comment "The compression algorithm" ;
  rdfs:domain :CipherObject .

:iv a owl:DatatypeProperty, owl:FunctionalProperty ;
  rdfs:comment "The initialization vector" ;
  rdfs:domain :CipherObject ;
  rdfs:range [
    a owl:Class ;
      owl:unionOf ( xsd:base64Binary xsd:hexBinary ) .
  ] .

:mediaType a owl:DatatypeProperty, owl:FunctionalProperty ;
  rdfs:comment "The MIME media type of the encrypted data" ;
  rdfs:domain :CipherObject ;
  rdfs:range xsd:string .

:value a owl:DatatypeProperty, owl:FunctionalProperty ;
  rdfs:comment "The ciphertext value" ;
  rdfs:domain :CipherObject ;
  rdfs:range [ 
    a owl:Class ;
      owl:unionOf ( xsd:base64Binary xsd:hexBinary ) .
  ] .

