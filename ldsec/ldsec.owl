@prefix : <http://www.w3.org/ns/ldsec#> .
@prefix ldsec: <http://www.w3.org/ns/ldsec#> .
@prefix owl: <http://www.w3.org/2002/07/owl#> .
@prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> .
@prefix xml: <http://www.w3.org/XML/1998/namespace> .
@prefix xsd: <http://www.w3.org/2001/XMLSchema#> .
@prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#> .
@base <http://www.w3.org/ns/ldsec#> .

<http://ns.jasnell.me/lds#> a owl:Ontology;
  rdfs:comment "A signature/encryption vocabulary"@en .

:JSONWebSignature a rdfs:Datatype ;
  rdfs:comment "A JSON Web Signature in Compact Form";
  owl:onDataype xsd:base64Binary .

:Signature a owl:Class ;
  rdfs:comment "Provides cryptographic Signature for a subject" .

:resource a owl:ObjectProperty, owl:FunctionalProperty ;
  rdfs:comment "The Subject on which the Signature is generated." ;
  rdfs:range owl:Thing ;
  rdfs:domain [
    a owl:Class ;
      owl:unionOf ( :Signature :Transform :Selection ) .
  ];
  owl:inverseOf :signature .

:signature a owl:ObjectProperty, owl:FunctionalProperty ;
  rdfs:comment "Specifies a Signature that verifies the Subject" ;
  rdfs:range :Signature ;
  rdfs:domain owl:Thing;
  owl:inverseOf :resource .

:alg a owl:ObjectProperty, owl:FunctionalProperty ;
  rdfs:comment "Identifies an algorithm." ;
  rdfs:range :Algorithm ;
  rdfs:domain [
    a owl:Class ;
      owl:unionOf ( :Signature :Key :CipherObject :Transform ) .
  ] .

:key a owl:ObjectProperty ;
  rdfs:comment "Identifies one or more keys used to generate the Signature." ;
  rdfs:range [
    a owl:Class ;
    owl:unionOf ( owl:Thing :EncryptedKey :CipherObject ) .
  ] ;
  rdfs:domain [
    a owl:Class ;
      owl:unionOf ( :Signature :CipherObject ) .
  ] .

:sig a owl:DatatypeProperty, owl:FunctionalProperty ;
  rdfs:comment "Specifies the Signature signature" ;
  rdfs:range xsd:base64Binary ;
  rdfs:domain :Signature .

## Transform and Selection

:Transform a owl:Class ;
  rdfs:comment "Describes a qualified transformation of a resource" .

:ExclusionTransform a owl:Class ;
  rdfs:subClassOf :Transform ;
  rdfs:comment "Modifies a resource by removing one or more selected predicates"@en .

:InclusionTransform a owl:Class ;
  rdfs:subClassOf :Transform ;
  rdfs:comment "Modifies a resource by selectively including one or more predicates"@en .

:MergeTransform a owl:Class ;
  rdfs:subClassOf :Transform ;
  rdfs:comment "Merges the graphs of multiple selected objects."@en .

:select a owl:ObjectProperty ;
  rdfs:range owl:Thing ;
  rdfs:domain [
    a owl:Class ;
      owl:unionOf ( :ExclusionTransform :InclusionTransform :Selection )
  ] .

:Selection a owl:Class .

:property a owl:ObjectProperty ;
  rdfs:comment "An object property to select"@en ;
  rdfs:range owl:ObjectProperty ;
  rdfs:domain :Selection ;


## Encrypted Key

:EncryptedKey a rdfs:Datatype .
:JSONEncryptedKey a rdfs:Datatype ;
  rdfs:subClassOf :EncryptedKey, :JSONWebEncryption ;
  rdfs:comment "An Encrypted JSON Web Key" .

## CipherObject

:JSONWebEncryption a rdfs:Datatype ;
  rdfs:comment "A JSON Web Encryption in Compact Form" ;
  owl:onDatatype xsd:base64Binary .

:CipherObject a owl:Class ;
  rdfs:comment "Encrypted Data" .

  ## :alg, :key, :x509, :kid all apply
  ## :alg is the content encryption algorithm in this case
  ## the :key might be an encrypted key, but if it is, it'll have it's own details...

:zip a owl:ObjectProperty, owl:FunctionalProperty ;
  rdfs:comment "The compression algorithm optionally applied to the data prior to encryption" ;
  rdfs:domain :CipherObject .

:iv a owl:DatatypeProperty, owl:FunctionalProperty ;
  rdfs:comment "The initialization vector" ;
  rdfs:domain :CipherObject ;
  rdfs:range xsd:base64Binary .

:mediaType a owl:DatatypeProperty, owl:FunctionalProperty ;
  rdfs:comment "The MIME media type of the encrypted data" ;
  rdfs:domain :CipherObject ;
  rdfs:range xsd:string .

:value a owl:DatatypeProperty, owl:FunctionalProperty ;
  rdfs:comment "The ciphertext value" ;
  rdfs:domain :CipherObject ;
  rdfs:range xsd:base64Binary .

